<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Q1_Global_Operations_Performance_Dashboard.xlsx</title>
    <style>
        body { margin: 0; font-family: 'Segoe UI', 'Malgun Gothic', sans-serif; background: #f3f3f3; color: #333; overflow: hidden; font-size: 12px; }
        .excel-header { background: #217346; color: white; padding: 6px 15px; font-size: 12px; font-weight: bold; display: flex; justify-content: space-between; }
        .excel-menu { background: #fff; border-bottom: 1px solid #ddd; padding: 5px 15px; display: flex; gap: 15px; border-top: 1px solid #eee; }
        
        /* 대시보드 레이아웃 */
        .dashboard-container { display: grid; grid-template-columns: 250px 1fr 300px; gap: 10px; padding: 10px; height: calc(100vh - 100px); }
        
        /* 섹션 스타일 */
        .widget { background: white; border: 1px solid #d4d4d4; padding: 10px; display: flex; flex-direction: column; }
        .widget-title { font-weight: bold; color: #217346; border-bottom: 2px solid #217346; padding-bottom: 5px; margin-bottom: 10px; display: flex; justify-content: space-between; }

        /* 무한 로딩 데이터 그리드 */
        .data-grid { flex: 1; overflow: hidden; font-family: 'Consolas', monospace; font-size: 11px; }
        table { border-collapse: collapse; width: 100%; text-align: right; }
        th { background: #f9f9f9; border: 1px solid #ddd; padding: 5px; font-weight: normal; }
        td { border: 1px solid #eee; padding: 4px; color: #444; }
        .highlight { color: #d32f2f; font-weight: bold; }
        .growth { color: #2e7d32; }

        /* 실시간 시스템 로그 */
        .log-area { background: #1a1a1a; color: #00ff00; padding: 10px; font-family: 'Consolas', monospace; font-size: 10px; height: 150px; overflow: hidden; border-radius: 4px; }

        /* 가짜 차트 영역 */
        .chart-box { border: 1px dashed #ccc; flex: 1; display: flex; align-items: flex-end; gap: 5px; padding: 10px; position: relative; }
        .bar { background: #217346; width: 100%; transition: height 0.5s ease; }

        /* 상태 바 */
        .status-bar { position: fixed; bottom: 0; width: 100%; background: #217346; color: white; font-size: 11px; padding: 4px 15px; display: flex; justify-content: space-between; }
        
        /* 깜빡이는 효과 */
        .blinker { animation: blink 1s infinite; }
        @keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.3; } 100% { opacity: 1; } }
    </style>
</head>
<body>

<div class="excel-header">
    <span>Excel - Quarterly_Global_Profit_Loss_Model_v4.2.xlsx</span>
    <span>Auto-Save: ON | Sync: Stable</span>
</div>
<div class="excel-menu">
    <b>File</b> <b>Home</b> <b>Insert</b> <b>Draw</b> <b>Page Layout</b> <b>Formulas</b> <b>Data</b> <b>Review</b> <b>View</b> <b>Automate</b>
</div>

<div class="dashboard-container">
    <div class="widget">
        <div class="widget-title">KPI Metrics <span class="blinker">●</span></div>
        <div style="font-size: 10px; color: #666; margin-bottom: 15px;">Refresh Rate: 500ms</div>
        <div id="kpi-list">
            </div>
        <div class="widget-title" style="margin-top:20px;">System Logs</div>
        <div class="log-area" id="log-display">
            Initializing sync...<br>
            Connecting to server...<br>
        </div>
    </div>

    <div class="widget">
        <div class="widget-title">Real-time Transaction Analysis (Global)</div>
        <div class="data-grid">
            <table id="data-table">
                <thead>
                    <tr><th>ID</th><th>Region</th><th>Revenue</th><th>Delta</th><th>Status</th></tr>
                </thead>
                <tbody id="data-body">
                    </tbody>
            </table>
        </div>
    </div>

    <div class="widget">
        <div class="widget-title">Visualized Trends</div>
        <div class="chart-box" id="chart-container">
            </div>
        <div style="margin-top: 20px;">
            <div class="widget-title">Quick Notes</div>
            <textarea style="width: 100%; height: 150px; border: 1px solid #ddd; font-size: 11px; padding: 5px; resize: none;">
- Q1 실적 데이터 취합 중 (Region A~F)
- 환율 변동에 따른 오차 범위 보정 필요
- 가중 평균값 재계산 (Michaelmas 기준)
- 다음 회의 안건: 운영 효율 극대화 방안
            </textarea>
        </div>
    </div>
</div>

<div class="status-bar">
    <div id="loading-msg">Ready - Calculating complex formulas...</div>
    <div>CPU Usage: 12% | RAM: 1.4GB | Cell: $AD$256</div>
</div>

<script>
    // 1. 가짜 데이터 생성기
    const regions = ['North Am', 'Europe', 'APAC', 'LATAM', 'Middle East', 'Africa'];
    const statuses = ['Pending', 'Verified', 'Processing', 'Synced'];

    function generateRow() {
        const id = Math.floor(Math.random() * 9000) + 1000;
        const region = regions[Math.floor(Math.random() * regions.length)];
        const rev = (Math.random() * 5000).toFixed(2);
        const delta = (Math.random() * 10 - 5).toFixed(2);
        const status = statuses[Math.floor(Math.random() * statuses.length)];
        
        const deltaClass = delta > 0 ? 'growth' : 'highlight';
        const deltaSymbol = delta > 0 ? '▲' : '▼';

        return `<tr><td>${id}</td><td>${region}</td><td>$${rev}</td><td class="${deltaClass}">${deltaSymbol}${Math.abs(delta)}%</td><td>${status}</td></tr>`;
    }

    // 2. 데이터 시트 업데이트 (계속 변함)
    const dataBody = document.getElementById('data-body');
    for(let i=0; i<25; i++) dataBody.innerHTML += generateRow();

    setInterval(() => {
        dataBody.deleteRow(-1);
        const newRow = dataBody.insertRow(0);
        newRow.innerHTML = generateRow().replace('<tr>', '').replace('</tr>', '');
    }, 800);

    // 3. 로그 업데이트
    const logDisplay = document.getElementById('log-display');
    const logMsgs = [
        "FETCHING data from SQL_SERVER_01...",
        "DATA_POINT validated.",
        "Updating Pivot Cache...",
        "Recalculating macro 'Auto_Calc_V2'...",
        "Warning: High latency in APAC node.",
        "Buffer cleared. Proceeding..."
    ];

    setInterval(() => {
        const msg = logMsgs[Math.floor(Math.random() * logMsgs.length)];
        logDisplay.innerHTML += `> ${msg}<br>`;
        if(logDisplay.innerHTML.length > 500) logDisplay.innerHTML = logDisplay.innerHTML.substring(200);
        logDisplay.scrollTop = logDisplay.scrollHeight;
    }, 1500);

    // 4. 가짜 차트 업데이트
    const chartContainer = document.getElementById('chart-container');
    for(let i=0; i<12; i++) {
        const bar = document.createElement('div');
        bar.className = 'bar';
        bar.style.height = Math.random() * 100 + '%';
        chartContainer.appendChild(bar);
    }

    setInterval(() => {
        const bars = document.querySelectorAll('.bar');
        bars.forEach(bar => {
            bar.style.height = Math.random() * 100 + '%';
        });
    }, 2000);

    // 5. 상태 표시줄 메시지
    const loadingMsgs = ["Calculating formulas...", "Refreshing Pivot Table...", "Syncing with Cloud...", "Formatting report..."];
    setInterval(() => {
        document.getElementById('loading-msg').innerText = loadingMsgs[Math.floor(Math.random() * loadingMsgs.length)];
    }, 3000);
</script>

</body>
</html>
