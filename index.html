<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>Daily_English_Learning_Report_2026.xlsx</title>
    <style>
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: #f3f3f3; color: #333; overflow: hidden; }
        .excel-header { background: #217346; color: white; padding: 6px 15px; font-size: 12px; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }
        .excel-menu { background: #fff; border-bottom: 1px solid #ddd; padding: 5px 15px; font-size: 13px; color: #444; display: flex; gap: 15px; }
        
        /* í•™ìŠµ ì˜ì—­ ì»¨í…Œì´ë„ˆ */
        .learning-container { display: flex; height: calc(100vh - 100px); }
        
        /* ì™¼ìª½: ì˜ì–´ ë¬¸ì¥ ë° í•´ì„ ì˜ì—­ */
        .left-panel { flex: 2; background: #fff; border-right: 1px solid #ddd; overflow-y: auto; padding: 15px; box-shadow: 2px 0 5px rgba(0,0,0,0.02); }
        .question-box { background: #e8f5e9; border: 1px solid #217346; padding: 15px; margin-bottom: 20px; border-radius: 4px; }
        .question-text { font-size: 18px; line-height: 1.5; font-weight: bold; color: #1a1a1a; margin-bottom: 10px; font-family: 'Segoe UI', sans-serif; }
        .answer-area { border-top: 1px dashed #ccc; padding-top: 15px; margin-top: 15px; }
        .user-translation-input { width: calc(100% - 10px); padding: 8px; border: 1px solid #ccc; border-radius: 3px; font-size: 14px; margin-bottom: 10px; font-family: 'Malgun Gothic', sans-serif; }
        .check-button { background: #217346; color: white; border: none; padding: 8px 15px; border-radius: 3px; cursor: pointer; font-size: 13px; }
        .check-button:hover { background: #1a5a35; }
        .translation-feedback { margin-top: 10px; padding: 10px; background: #f0f0f0; border-radius: 3px; font-size: 14px; display: none; }
        .correct-answer { color: #1a5a35; font-weight: bold; margin-bottom: 5px; }
        .mistakes { color: #b71c1c; font-style: italic; }

        /* ì˜¤ë¥¸ìª½: íƒ€ì´í•‘ ì—°ìŠµ ì—‘ì…€ ì‹œíŠ¸ */
        .right-panel { flex: 3; background: #f9f9f9; overflow-y: auto; padding: 15px; }
        .typing-instruction { font-size: 13px; color: #555; margin-bottom: 10px; }
        table { border-collapse: collapse; width: 100%; table-layout: fixed; }
        th { background: #e6e6e6; border: 1px solid #d4d4d4; font-weight: normal; font-size: 11px; height: 20px; }
        td { border: 1px solid #d4d4d4; height: 35px; padding: 0 5px; }
        .row-num { background: #e6e6e6; text-align: center; width: 40px; color: #666; }
        
        .typing-input { width: 100%; height: 100%; border: none; outline: none; background: transparent; font-family: 'Consolas', monospace; font-size: 15px; color: #0000ff; }
        .active-cell { outline: 2px solid #217346; background: #fff; }

        /* íƒ€ì´í•‘ í”¼ë“œë°± (ê¸€ìë³„) */
        #typing-display { font-size: 16px; line-height: 1.5; letter-spacing: 0.5px; margin-bottom: 10px; font-family: 'Consolas', monospace; min-height: 40px; padding: 5px; background: #fdfdfd; border: 1px solid #eee; border-radius: 3px; }
        .char-correct { color: #ccc; }
        .char-current { background-color: #ffeb3b; color: #000; font-weight: bold; }
        .char-wrong { background-color: #ffcdd2; color: #b71c1c; }

        .status-bar { position: fixed; bottom: 0; width: 100%; background: #217346; color: white; font-size: 11px; padding: 4px 15px; display: flex; justify-content: space-between; }
        
        .nav-buttons { display: flex; gap: 10px; }
        .nav-buttons button { background: #4CAF50; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 12px; }
        .nav-buttons button:hover { background: #388E3C; }
        .nav-buttons button:disabled { background: #a5d6a7; cursor: not-allowed; }
    </style>
</head>
<body>

<div class="excel-header">
    <span>Excel - Daily_English_Study_Report.xlsx</span>
    <div class="nav-buttons">
        <button id="prevBtn" disabled>â—€ ì´ì „</button>
        <button id="nextBtn">ë‹¤ìŒ â–¶</button>
    </div>
</div>
<div class="excel-menu">
    <span>File</span> <span>Home</span> <span>Insert</span> <span>Data</span> <span>Review</span> <span>View</span>
</div>

<div class="learning-container">
    <div class="left-panel">
        <div class="question-box">
            <span style="font-size: 12px; color: #555; display: block; margin-bottom: 5px;">ğŸ“ TODAY'S PHRASE (ì˜¤ëŠ˜ì˜ í‘œí˜„)</span>
            <div id="english-phrase" class="question-text">Loading English phrase...</div>
        </div>

        <div class="answer-area">
            <span style="font-size: 12px; color: #555; display: block; margin-bottom: 8px;">âœï¸ YOUR TRANSLATION (ë‚˜ì˜ í•´ì„)</span>
            <textarea id="user-translation" class="user-translation-input" rows="3" placeholder="ì—¬ê¸°ì— ë‹¹ì‹ ì˜ í•´ì„ì„ ì…ë ¥í•´ë³´ì„¸ìš”."></textarea>
            <button id="check-translation-btn" class="check-button">í•´ì„ í™•ì¸</button>
            <div id="translation-feedback" class="translation-feedback">
                <div class="correct-answer">âœ”ï¸ ì •ë‹µ: <span id="correct-ko"></span></div>
                <div class="mistakes" id="mistake-feedback"></div>
            </div>
        </div>
    </div>

    <div class="right-panel">
        <div class="typing-instruction">
            <span style="font-size: 12px; color: #217346; font-weight: bold;">ğŸ“ EXCEL TYPING EXERCISE (ì—‘ì…€ ì…ë ¥ ì—°ìŠµ)</span><br>
            <span style="font-size: 11px; color: #666;">ìœ„ ì˜ë¬¸ ë¬¸ì¥ì„ ì•„ë˜ ì…€ì— ë˜‘ê°™ì´ ì…ë ¥í•˜ì„¸ìš”.</span>
        </div>
        <div id="typing-display"></div> <table>
            <tr><th></th><th>A</th><th>B</th><th>C</th><th>D</th><th>E</th></tr>
            <tr>
                <td class="row-num">1</td>
                <td colspan="5" class="active-cell">
                    <input type="text" id="typer" class="typing-input" placeholder="Start typing here..." autocomplete="off" autofocus>
                </td>
            </tr>
            <script>
                for(let i=2; i<=15; i++) { // ë” ë§ì€ í–‰ì„ ë§Œë“¤ í•„ìš”ê°€ ì—†ì–´ ì¤„ì„
                    document.write(`<tr><td class="row-num">${i}</td><td></td><td></td><td></td><td></td><td></td></tr>`);
                }
            </script>
        </table>
    </div>
</div>

<div class="status-bar">
    <div>ğŸ“Š REPORTING: Current Progress</div>
    <div id="progress-status">PHRASE <span id="current-num">1</span> OF <span id="total-num">5</span> | MEMORIZED: 0</div>
</div>

<script>
    const phrases = [
        { en: "Cut to the chase.", ko: "ë°”ë¡œ ë³¸ë¡ ìœ¼ë¡œ ë“¤ì–´ê°€.", details: "ë¶ˆí•„ìš”í•œ ì–˜ê¸°ëŠ” ê±´ë„ˆë›°ê³  í•µì‹¬ë§Œ ë§í•˜ë¼ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤. íšŒì˜ë‚˜ ëŒ€í™”ì—ì„œ ìì£¼ ì‚¬ìš©ë¼ìš”." },
        { en: "It's a piece of cake.", ko: "ê·¸ê±° ì‹ì€ ì£½ ë¨¹ê¸°ì•¼.", details: "ì•„ì£¼ ì‰½ë‹¤ëŠ” ëœ»ìœ¼ë¡œ, 'piece of cake'ëŠ” ì¼€ì´í¬ í•œ ì¡°ê°ì²˜ëŸ¼ ì‰½ë‹¤ëŠ” ë¹„ìœ ì…ë‹ˆë‹¤." },
        { en: "Let's play it by ear.", ko: "ìƒí™© ë´ì„œ ê²°ì •í•˜ì.", details: "ë¯¸ë¦¬ ê³„íší•˜ê¸°ë³´ë‹¤ ê·¸ë•Œê·¸ë•Œ ìƒí™©ì— ë§ì¶° ìœ ì—°í•˜ê²Œ ëŒ€ì²˜í•˜ìëŠ” í‘œí˜„ì…ë‹ˆë‹¤." },
        { en: "I'm all ears.", ko: "ê²½ì²­í•˜ê³  ìˆì–´. (ê·€ ê¸°ìš¸ì—¬ ë“£ê³  ìˆì–´.)", details: "ìƒëŒ€ë°©ì˜ ë§ì„ ì£¼ì˜ ê¹Šê²Œ ë“£ê³  ìˆì„ ë•Œ ì“°ëŠ” í‘œí˜„ìœ¼ë¡œ, 'ëª¨ë“  ê·€ê°€ ë‹¤ ë„ˆì—ê²Œ ì§‘ì¤‘ë˜ì–´ ìˆë‹¤'ëŠ” ëœ»ì…ë‹ˆë‹¤." },
        { en: "No sweat.", ko: "ë³„ê±° ì•„ë‹ˆì•¼. (ê±±ì • ë§ˆ.)", details: "ì–´ë µì§€ ì•Šê±°ë‚˜ ë¬¸ì œê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ëœ»ìœ¼ë¡œ, 'ë•€ í˜ë¦´ ì¼ë„ ì•„ë‹ˆë‹¤'ë¼ëŠ” ë¹„ìœ ì…ë‹ˆë‹¤." },
        { en: "Hit the road.", ko: "ì¶œë°œí•˜ì. (ê°€ì.)", details: "ì–´ë–¤ ì¥ì†Œë¥¼ ë– ë‚˜ ì—¬í–‰ì´ë‚˜ ì´ë™ì„ ì‹œì‘í•  ë•Œ ì‚¬ìš©í•˜ëŠ” í‘œí˜„ì…ë‹ˆë‹¤." },
        { en: "Bite the bullet.", ko: "ì´ë¥¼ ì•…ë¬¼ê³  ì°¸ë‹¤. (ê³ í†µì„ ê°ë‚´í•˜ë‹¤.)", details: "ì–´ë µê±°ë‚˜ ë¶ˆì¾Œí•œ ìƒí™©ì„ ë°›ì•„ë“¤ì´ê³  ê²¬ëŒë‚¼ ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤." }
    ];

    let currentPhraseIndex = 0;
    let memorizedCount = 0;

    const englishPhraseEl = document.getElementById('english-phrase');
    const userTranslationInput = document.getElementById('user-translation');
    const checkTranslationBtn = document.getElementById('check-translation-btn');
    const translationFeedbackEl = document.getElementById('translation-feedback');
    const correctKoEl = document.getElementById('correct-ko');
    const mistakeFeedbackEl = document.getElementById('mistake-feedback');
    const typingDisplayEl = document.getElementById('typing-display');
    const typerInput = document.getElementById('typer');
    const currentNumEl = document.getElementById('current-num');
    const totalNumEl = document.getElementById('total-num');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const progressStatusEl = document.getElementById('progress-status');

    totalNumEl.innerText = phrases.length;

    function renderPhrase() {
        const phrase = phrases[currentPhraseIndex];
        englishPhraseEl.innerText = phrase.en;
        userTranslationInput.value = '';
        translationFeedbackEl.style.display = 'none';
        typerInput.value = '';
        updateTypingDisplay();
        updateNavigationButtons();
        currentNumEl.innerText = currentPhraseIndex + 1;
    }

    function updateTypingDisplay() {
        const target = phrases[currentPhraseIndex].en;
        const userInput = typerInput.value;
        let html = '';
        for (let i = 0; i < target.length; i++) {
            if (i < userInput.length) {
                html += `<span class="${userInput[i] === target[i] ? 'char-correct' : 'char-wrong'}">${target[i]}</span>`;
            } else if (i === userInput.length) {
                html += `<span class="char-current">${target[i]}</span>`;
            } else {
                html += `<span>${target[i]}</span>`;
            }
        }
        typingDisplayEl.innerHTML = html;
        if (userInput === target) {
             typingDisplayEl.style.backgroundColor = "#e8f5e9"; // ì„±ê³µ ì‹œ ì ì‹œ ë°°ê²½ìƒ‰ ë³€ê²½
             setTimeout(() => typingDisplayEl.style.backgroundColor = "transparent", 200);
        }
    }

    function updateNavigationButtons() {
        prevBtn.disabled = currentPhraseIndex === 0;
        nextBtn.disabled = currentPhraseIndex === phrases.length - 1 && typerInput.value !== phrases[currentPhraseIndex].en; // ë§ˆì§€ë§‰ ë¬¸ì¥ì„ ë‹¤ ì³ì•¼ ë‹¤ìŒ ë¹„í™œì„±í™”
    }

    prevBtn.addEventListener('click', () => {
        if (currentPhraseIndex > 0) {
            currentPhraseIndex--;
            renderPhrase();
        }
    });

    nextBtn.addEventListener('click', () => {
        // í˜„ì¬ ë¬¸ì¥ì„ ë‹¤ ì¹˜ì§€ ì•Šìœ¼ë©´ ë„˜ì–´ê°€ì§€ ëª»í•˜ë„ë¡ (ì•”ê¸° íš¨ê³¼ ì¦ëŒ€)
        if (typerInput.value !== phrases[currentPhraseIndex].en) {
            alert('ë¨¼ì € í˜„ì¬ ë¬¸ì¥ì„ ì •í™•íˆ ì…ë ¥í•´ì•¼ ë‹¤ìŒìœ¼ë¡œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            return;
        }
        if (currentPhraseIndex < phrases.length - 1) {
            currentPhraseIndex++;
            renderPhrase();
        } else {
            alert('ëª¨ë“  ë¬¸ì¥ì„ í•™ìŠµí•˜ì…¨ìŠµë‹ˆë‹¤! ë‹¤ìŒ ì—…ë°ì´íŠ¸ë¥¼ ê¸°ëŒ€í•´ì£¼ì„¸ìš”.');
            // ëª¨ë“  ë¬¸ì¥ì„ ë‹¤ ì™¸ì› ì„ ë•Œ ì–´ë–¤ ì•¡ì…˜ì„ í• ì§€ ì—¬ê¸°ì— ì¶”ê°€
        }
    });

    checkTranslationBtn.addEventListener('click', () => {
        const userTrans = userTranslationInput.value.trim();
        const correctTrans = phrases[currentPhraseIndex].ko;
        const details = phrases[currentPhraseIndex].details;

        correctKoEl.innerText = correctTrans;
        mistakeFeedbackEl.innerText = details || "";
        translationFeedbackEl.style.display = 'block';

        // ì—¬ê¸°ì—ì„œ ì‚¬ìš©ì ë²ˆì—­ê³¼ ì •ë‹µ ë²ˆì—­ì„ ë¹„êµí•˜ì—¬ ì°¨ì´ì ì„ ë³´ì—¬ì£¼ëŠ” ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        // (ex. í…ìŠ¤íŠ¸ ìœ ì‚¬ë„ ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©)
    });

    typerInput.addEventListener('input', updateTypingDisplay);
    typerInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            const target = phrases[currentPhraseIndex].en;
            if (typerInput.value === target) {
                // ë¬¸ì¥ì„ ì •í™•íˆ ì…ë ¥í•˜ë©´ 'ì™¸ì› ìŒ'ìœ¼ë¡œ ê°„ì£¼í•˜ê³  ìƒíƒœ ì—…ë°ì´íŠ¸
                memorizedCount++;
                progressStatusEl.innerHTML = `PHRASE <span id="current-num">${currentPhraseIndex + 1}</span> OF <span id="total-num">${phrases.length}</span> | MEMORIZED: ${memorizedCount}`;
                updateNavigationButtons(); // 'ë‹¤ìŒ' ë²„íŠ¼ í™œì„±í™” ì—¬ë¶€ ë‹¤ì‹œ ê²€ì‚¬
            }
        }
    });


    // ì´ˆê¸° ë¡œë“œ
    renderPhrase();
</script>

</body>
</html>
